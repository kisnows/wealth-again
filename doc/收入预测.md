# ✅ 更新后的《个人资产账户管理需求文档》

在你原有文档的 **第四章 / 七章之后**，我新增了 **第八章：收入预测计算**

---

## 八、收入预测计算

### 1) 计算逻辑

1. **累计收入计税**

   - 个税计算需从自然年 **1 月开始累计**，逐月累加收入并扣除每月社保、公积金基数后，再匹配税率表。
   - 即使预测 5–8 月，也必须从 1–8 月逐月计算，再截取 5–8 月部分展示。
   - 避免错误地“直接从 5 月起按 3% 税率计算”，而忽略前几个月已进入更高税率档的情况。

2. **社保、公积金计算规则**

   - 每个月社保、公积金计算基于当月生效的上下限基数（随政策时间变化）。
   - 示例：

     - 1–4 月社保基数上下限：500–1000
     - 5 月起调整为：600–1200
     - 则 1–4 月按前者计算，5 月及以后按新规则计算。

   - 公积金同理。
   - 如果更早没有记录，使用最早一条有效记录作为默认值。

3. **展示口径**

   - 在收入预测页面展示：

     - 每月 **收入/社保/公积金/应纳税额/个税/税后收入** 明细
     - 指定月份区间的合计与趋势图

   - 支持按城市规则自动套算（需预置各城市社保/公积金政策）。

---

## 九、数据追溯与扩展

- **社保/公积金政策表**：需带有效期，确保历史月份按历史规则计算。
- **个税速算扣除数**：保留政策快照，避免未来政策变化导致历史数据重算错误。
- **收入预测提醒**：若用户只录入未来收入预测，则需系统补齐从年初至今的累计计算逻辑。

---

# ✅ 新增 PRD 文档

## 产品需求文档（PRD）—— 收入预测计算模块

### 一、目标

在资产管理系统中，提供准确的 **收入预测与税后收入计算**，避免因忽略年度累计与政策变动而导致结果失真。

---

### 二、功能需求

1. **累计计税**

   - 从 1 月起逐月累计收入、扣除社保/公积金，再套用税率表。
   - 即使用户只看 5–8 月，也必须计算 1–8 月后再截取展示。

2. **动态社保/公积金计算**

   - 每月根据当月有效政策计算（上下限、比例）。
   - 政策若发生调整，需精确分割计算区间。

3. **预测展示**

   - 月度明细表（收入、社保、公积金、应纳税额、个税、税后收入）。
   - 区间合计与趋势折线图。

4. **数据追溯**

   - 保留政策版本与生效日期，确保历史数据追溯一致。

---

### 三、案例说明

#### 案例 1：社保计算

- 用户城市：上海
- 1–4 月社保上下限：500–1000
- 5 月起调整为：600–1200
- 月工资：8000
- 结果：

  - 1–4 月按 500–1000 基数算社保
  - 5 月起按 600–1200 基数算社保

#### 案例 2：公积金计算

- 公积金比例：7%
- 1–6 月基数上下限：2000–8000
- 7 月起调整为：2500–9000
- 月工资：10000
- 结果：

  - 1–6 月按 8000 × 7% = 560 缴纳
  - 7 月起按 9000 × 7% = 630 缴纳

#### 案例 3：个税计算

- 年度速算扣除额：5000/月
- 1–4 月收入：1 万/月
- 5–8 月收入预测：1.5 万/月
- 计算方式：

  - 1–8 月累计收入 – 累计社保/公积金 – 累计专项扣除 = 应纳税所得额
  - 按累计税率档次计算应纳税额，再减去已缴税额 → 当月应缴个税

- 结果：

  - 5 月不会按“3%起算”，而是继续按已进入的 **20% 或 30% 档**。
