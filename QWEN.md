# 个人财富管理系统需求文档

## 一、需求概述

本系统用于管理个人的 **收入、税收、社保、公积金** 以及 **投资账户与收益**。  
目标是帮助用户：

- 精确计算 **税前/税后收入**（结合中国税收政策及杭州 2025 年社保、公积金规则）
- 提供 **未来收入预测** 功能
- 管理 **多个投资账户**，计算真实收益与收益率
- 支持 **多币种与汇率换算**

---

## 二、个人收入管理

### 1. 收入记录

- 支持录入每月税前工资
- 支持季度奖金、年度奖金录入
- 所有收入均为 **税前收入**

### 2. 税后收入计算

- 根据税前收入、社保、公积金、个税政策计算税后收入
- 考虑中国个人所得税累进税率（七级，3%–45%）
- 结合 **杭州 2025 年社保、公积金**：
  - 社保基数：4812–24930 元/月
    - 养老：单位 14%，个人 8%
    - 医疗：单位 9.5%，个人 2%
    - 失业：单位 0.5%，个人 0.5%
    - 工伤：单位 0.2%，个人不缴
    - 生育：单位 0.5%，个人不缴
  - 公积金基数：2490–40694 元/月（2025.7.1–2026.6.30）
    - 单位比例：5%–12%
    - 灵活就业比例：10%–24%

### 3. 收入管理表单

- 提供前端表单录入工资、奖金、长期现金
- 所有收入按 **自然月最后一天** 合并处理

### 4. 收入预测功能

- 基于历史收入、奖金、税务变动预测未来收入
- 支持设置预测周期（3 个月 / 6 个月 / 1 年）
- 当税务政策有未来生效日期时，自动应用到预测结果

### 5. 多币种与汇率支持

- 可录入多币种收入
- 系统自动换算为用户设定的默认货币

---

## 三、记录与更新管理

1. **收入历史管理**：保存所有调整记录（改动时间 + 生效时间）
2. **奖金管理**：奖金需有生效日期，与当月工资合并计算税费
3. **估值快照更新**：添加新估值时，展示所有更新历史；超过 50 行分页展示
4. **现金流/交易记录历史**：同样遵循分页与历史追溯逻辑

---

## 四、税务参数配置

### 1. 税务政策记录

- 每项税务政策需带有 **生效日期**
- 支持提前录入未来政策（如新的个税调整）
- 税务是按照国家为维度的

### 2. 排序与管理

- 税务政策按生效日期排序
- 支持查询历史与即将生效的政策

### 3. 动态更新

- 税务政策变更后，预测功能应自动更新计算逻辑

---

## 五、收入预测功能

### 1. 预测逻辑

- 依据 **历史收入 + 奖金记录 + 税务生效日期**
- 自动重新计算未来的税前税后收入

### 2. 变动点标注

- 在预测表中标注工资变动、奖金发放、税务调整等关键点

### 3. 收入合并计算

- 工资与奖金均按自然月月底合并计算税费与社保
  > 例如：2025 年 8 月 19 日发放奖金 → 与 8 月工资合并计算

### 4. 收入预测表格

表头应包括：

```

月份 | 税前总收入 | 税后总收入 | 社保 | 公积金 | 税 | 工资 | 奖金 | 长期现金 | 适用税率 | 备注 | 累计总收入

```

### 5. 图表展示

- **柱状图**：每月税前总收入 vs 税后总收入
- **折线图**：预测周期内税前累计收入 vs 税后累计收入趋势

---

## 六、投资管理系统

### 1. 账户管理

- 支持多个投资账户（券商、基金、理财等）
- 每个账户记录 **初始资金、存款、取款、转账**

### 2. 投资收益计算

- 任意时间点本金计算：  
  **本金 = 初始资金 + 存款 – 取款**
- 收益：  
  **收益 = 当前估值 – 本金**
- 收益率：  
  **收益率 = 收益 ÷ 本金**

### 3. 投资记录管理

- 所有变动与估值更新均保存详细记录
- 支持按时间排序与分页展示
- 多货币投资支持汇率换算

---

## 七、页面结构设计

| 页面名称          | 功能概要                                                 |
| ----------------- | -------------------------------------------------------- |
| 城市与全局设置页  | 设置城市、默认货币                                       |
| 社保/公积金规则页 | 管理基数、比例、生效时间，支持版本回溯                   |
| 税率管理页        | 展示并可修改七级税率                                     |
| 收入与纳税计算页  | 输入收入，实时计算应纳税额与边际税率                     |
| 收入预测页        | 展示预测表格与图表，标注变动点                           |
| 投资账户管理页    | 账户管理、存取款、估值更新、收益率计算，支持多币种与转账 |

---

## 八、技术要求

- **后端**：Node.js + TypeScript
- **前端**：React + TailwindCSS (v4.x)
- **组件库**：Shadcn UI
- **API**：RESTful API（可考虑 Next.js 一体化方案）
- **数据库**：轻量级（如 SQLite / PostgreSQL），支持历史数据追溯

---

## 九、其他需求

1. **分页功能**：所有历史记录超过 50 行时分页展示
2. **历史记录管理**：收入、税务、投资等均需可追溯
3. **多币种支持**：收入与投资均需自动换算
